{"ast":null,"code":"import _regeneratorRuntime from\"/home/oskaragh/stremingly/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/oskaragh/stremingly/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/oskaragh/stremingly/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef,useContext}from\"react\";import PlayCircleOutlineIcon from\"@material-ui/icons/PlayCircleOutline\";import SkipPreviousIcon from\"@material-ui/icons/SkipPrevious\";import SkipNextIcon from\"@material-ui/icons/SkipNext\";import ShuffleIcon from\"@material-ui/icons/Shuffle\";import PauseCircleOutlineIcon from\"@material-ui/icons/PauseCircleOutline\";import\"./Player.css\";import{Grid}from\"@material-ui/core\";import PlayerContext from'../context/PlayerContext';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Player(props){var _useContext=useContext(PlayerContext),currentSong=_useContext.currentSong,songs=_useContext.songs,albums=_useContext.albums,nextSong=_useContext.nextSong,prevSong=_useContext.prevSong,random=_useContext.random,playing=_useContext.playing,toggleRandom=_useContext.toggleRandom,togglePlaying=_useContext.togglePlaying,handleEnd=_useContext.handleEnd,setAlbum=_useContext.setAlbum;var audio=useRef('audio_tag');// self State\nvar _useState=useState(0.3),_useState2=_slicedToArray(_useState,1),statevolum=_useState2[0];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),dur=_useState4[0],setDur=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),currentTime=_useState6[0],setCurrentTime=_useState6[1];var fmtMSS=function fmtMSS(s){return(s-(s%=60))/60+(9<s?':':':0')+~~s;};var toggleAudio=function toggleAudio(){return audio.current.paused?audio.current.play():audio.current.pause();};useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios(\"http://localhost:3000/api/albums?limit=1000&offset=0\");case 2:result=_context.sent;setAlbum(result.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[]);var handleProgress=function handleProgress(e){var compute=e.target.value*dur/100;setCurrentTime(compute);audio.current.currentTime=compute;};useEffect(function(){audio.current.volume=statevolum;if(playing){toggleAudio();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[currentSong]);// eslint-disable-next-line no-lone-blocks\n{if(typeof songs[currentSong].artists!=='undefined'&&typeof songs[currentSong].genres!=='undefined'){var newArtist=songs[currentSong].artists.toString().replace(/[0-9]/g,'').replace(',',' ');var newGenre=songs[currentSong].genres.toString().replace(/[0-9]/g,'').replace(',',' ').replace(',,',' ').replace(',,',' ');return/*#__PURE__*/_jsxs(\"div\",{className:\"footer\",children:[/*#__PURE__*/_jsx(\"audio\",{onTimeUpdate:function onTimeUpdate(e){return setCurrentTime(e.target.currentTime);},onCanPlay:function onCanPlay(e){return setDur(e.target.duration);},onEnded:handleEnd,ref:audio,type:\"audio/mpeg\",preload:\"true\",src:\"http://localhost:3000/media/\"+songs[currentSong].media}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer__left\",children:[albums.filter(function(album){return album.id===songs[currentSong].album_id;}).map(function(album){return/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:3000/media/\"+album.media,alt:\"\",className:\"footer__albumLogo\"},album.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer__songInfo\",children:[/*#__PURE__*/_jsx(\"h4\",{children:songs[currentSong].title}),/*#__PURE__*/_jsxs(\"p\",{children:[newArtist,\" - \",newGenre]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer__center\",children:[/*#__PURE__*/_jsx(ShuffleIcon,{onClick:toggleRandom,className:\"random \"+(random?'ractive':'')}),/*#__PURE__*/_jsx(SkipPreviousIcon,{onClick:prevSong,className:\"footer__icon\"}),playing?/*#__PURE__*/_jsx(PauseCircleOutlineIcon,{onClick:function onClick(){togglePlaying();toggleAudio();},fontSize:\"large\",className:\"footer__icon__play\"}):/*#__PURE__*/_jsx(PlayCircleOutlineIcon,{onClick:function onClick(){togglePlaying();toggleAudio();},fontSize:\"large\",className:\"footer__icon__play\"}),/*#__PURE__*/_jsx(SkipNextIcon,{onClick:nextSong,className:\"footer__icon\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer__right\",children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,children:[/*#__PURE__*/_jsx(Grid,{item:true}),/*#__PURE__*/_jsx(Grid,{item:true,xs:true,children:/*#__PURE__*/_jsxs(\"div\",{className:\"progressb\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"currentT\",children:fmtMSS(currentTime)}),/*#__PURE__*/_jsx(\"input\",{onChange:handleProgress,value:dur?currentTime*100/dur:0,type:\"range\",name:\"progresBar\",id:\"prgbar\"}),/*#__PURE__*/_jsx(\"span\",{className:\"totalT\",children:fmtMSS(dur)})]})})]})})]});}}}export default Player;","map":null,"metadata":{},"sourceType":"module"}